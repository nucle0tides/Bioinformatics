sub output collected 
    print gene 
    print seq 
    if !defined(left)
        left = 0
        right = len seq

    my len = right - left 
    print 
    print 

while<>
    if header
    output collected if seq
    parts = split ""
    left = parts1 right = parts2
    fields = slit | parts0
    gene = fields1

    seq = ""

    chomp 
    seq += $_

output collected if seq